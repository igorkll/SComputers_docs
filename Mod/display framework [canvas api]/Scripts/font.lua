font = {}
font.width = 4
font.height = 5

font.chars = {
	----------big english fonts
	["A"] = {
		".11.",
		"1..1",
		"1111",
		"1..1",
		"1..1"
	},
	["B"] = {
		"111.",
		"1..1",
		"111.",
		"1..1",
		"111."
	},
	["C"] = {
		".11.",
		"1..1",
		"1...",
		"1..1",
		".11."
	},
	["D"] = {
		"111.",
		"1..1",
		"1..1",
		"1..1",
		"111."
	},
	["E"] = {
		"1111",
		"1...",
		"111.",
		"1...",
		"1111"
	},
	["F"] = {
		"1111",
		"1...",
		"111.",
		"1...",
		"1..."
	},
	["G"] = {
		".111",
		"1...",
		"1.11",
		"1..1",
		".11."
	},
	["H"] = {
		"1..1",
		"1..1",
		"1111",
		"1..1",
		"1..1"
	},
	["I"] = {
		"1111",
		".11.",
		".11.",
		".11.",
		"1111"
	},
	["J"] = {
		"1111",
		".11.",
		".11.",
		".11.",
		"11.."
	},
	["K"] = {
		"1..1",
		"1..1",
		"111.",
		"1..1",
		"1..1"
	},
	["L"] = {
		"1...",
		"1...",
		"1...",
		"1...",
		"1111"
	},
	["M"] = {
		"1..1",
		"1111",
		"1..1",
		"1..1",
		"1..1"
	},
	["N"] = {
		"1..1",
		"11.1",
		"1.11",
		"1..1",
		"1..1"
	},
	["O"] = {
		".11.",
		"1..1",
		"1..1",
		"1..1",
		".11."
	},
	["P"] = {
		"111.",
		"1..1",
		"111.",
		"1...",
		"1..."
	},
	["Q"] = {
		".11.",
		"1..1",
		"1..1",
		"1..1",
		".111"
	},
	["R"] = {
		"111.",
		"1..1",
		"111.",
		"1..1",
		"1..1"
	},
	["S"] = {
		".111",
		"1...",
		".11.",
		"...1",
		"111."
	},
	["T"] = {
		"1111",
		".11.",
		".11.",
		".11.",
		".11."
	},
	["U"] = {
		"1..1",
		"1..1",
		"1..1",
		"1..1",
		".111"
	},
	["V"] = {
		"1..1",
		"1..1",
		"1..1",
		"1..1",
		".11."
	},
	["W"] = {
		"1..1",
		"1..1",
		"1..1",
		"1111",
		"1..1"
	},
	["X"] = {
		"1..1",
		"1..1",
		".11.",
		"1..1",
		"1..1"
	},
	["Y"] = {
		"1..1",
		"1..1",
		".111",
		"...1",
		".11."
	},
	["Z"] = {
		"1111",
		"...1",
		".11.",
		"1...",
		"1111"
	},

	----------small english fonts
	["a"] = {
		"....",
		".11.",
		"...1",
		"1111",
		".111"
	},
	["b"] = {
		"....",
		"1...",
		"111.",
		"1..1",
		"111."
	},
	["c"] = {
		"....",
		".111",
		"1...",
		"1...",
		".111"
	},
	["d"] = {
		"...",
		"...1",
		".111",
		"1..1",
		".111"
	},
	["e"] = {
		"....",
		"1111",
		"111.",
		"1...",
		"1111"
	},
	["f"] = {
		"....",
		"1111",
		"1...",
		"111.",
		"1..."
	},
	["g"] = {
		"....",
		".111",
		"1...",
		"1..1",
		".11."
	},
	["h"] = {
		"....",
		"1...",
		"1111",
		"1..1",
		"1..1"
	},
	["i"] = {
		"....",
		".11.",
		"....",
		".11.",
		".11."
	},
	["j"] = {
		"....",
		"..1.",
		"..1.",
		"..1.",
		"11.."
	},
	["k"] = {
		"....",
		"1...",
		"1..1",
		"111.",
		"1..1"
	},
	["l"] = {
		"....",
		"1...",
		"1...",
		"1...",
		"1111"
	},
	["m"] = {
		"....",
		"1..1",
		"1111",
		"1..1",
		"1..1"
	},
	["n"] = {
		"....",
		"111.",
		"1..1",
		"1..1",
		"1..1"
	},
	["o"] = {
		"....",
		".11.",
		"1..1",
		"1..1",
		".11."
	},
	["p"] = {
		"....",
		"111.",
		"1..1",
		"111.",
		"1..."
	},
	["q"] = {
		"....",
		".11.",
		"1..1",
		"1111",
		"...1"
	},
	["r"] = {
		"....",
		"11.1",
		"1.1.",
		"1...",
		"1..."
	},
	["s"] = {
		"....",
		"..11",
		".1..",
		"..1.",
		"11.."
	},
	["t"] = {
		"....",
		"1111",
		".11.",
		".11.",
		".11."
	},
	["u"] = {
		"....",
		"1..1",
		"1..1",
		"1..1",
		".111"
	},
	["v"] = {
		"....",
		"1..1",
		"1..1",
		"1..1",
		".11."
	},
	["w"] = {
		"....",
		"1..1",
		"1..1",
		"1111",
		"1..1"
	},
	["x"] = {
		"....",
		"1..1",
		".11.",
		".11.",
		"1..1"
	},
	["y"] = {
		"....",
		"1..1",
		".111",
		"...1",
		".11."
	},
	["z"] = {
		"....",
		"1111",
		"..1.",
		".1..",
		"1111"
	},





	----------big russian fonts
	["А"] = {
		".11.",
		"1..1",
		"1111",
		"1..1",
		"1..1"
	},
	["Б"] = {
		"1111",
		"1...",
		"111.",
		"1..1",
		"111."
	},
	["В"] = {
		"111.",
		"1..1",
		"111.",
		"1..1",
		"111."
	},
	["Г"] = {
		"1111",
		"1...",
		"1...",
		"1...",
		"1..."
	},
	["Д"] = {
		".11.",
		"1..1",
		"1..1",
		".11.",
		"1..1"
	},
	["Е"] = {
		"1111",
		"1...",
		"1111",
		"1...",
		"1111"
	},
	["Ё"] = {
		"11.1",
		"1...",
		"1111",
		"1...",
		"1111"
	},
	["Ж"] = {
		"1..1",
		".11.",
		"1111",
		".11.",
		"1..1"
	},
	["З"] = {
		"111.",
		"...1",
		".11.",
		"...1",
		"111."
	},
	["И"] = {
		"1..1",
		"1..1",
		"1.11",
		"11.1",
		"1..1"
	},
	["Й"] = {
		"1.11",
		"1..1",
		"1.11",
		"11.1",
		"1..1"
	},
	["К"] = {
		"1..1",
		"1.1.",
		"11..",
		"1.1.",
		"1..1"
	},
	["Л"] = {
		".111",
		"1..1",
		"1..1",
		"1..1",
		"1..1"
	},
	["М"] = {
		"1..1",
		"1111",
		"1..1",
		"1..1",
		"1..1"
	},
	["Н"] = {
		"1..1",
		"1..1",
		"1111",
		"1..1",
		"1..1"
	},
	["О"] = {
		".11.",
		"1..1",
		"1..1",
		"1..1",
		".11."
	},
	["П"] = {
		"1111",
		"1..1",
		"1..1",
		"1..1",
		"1..1"
	},
	["Р"] = {
		"111.",
		"1..1",
		"111.",
		"1...",
		"1..."
	},
	["С"] = {
		".111",
		"1...",
		"1...",
		"1...",
		".111"
	},
	["Т"] = {
		"1111",
		".11.",
		".11.",
		".11.",
		".11."
	},
	["У"] = {
		"1..1",
		"1..1",
		".1.1",
		"..1.",
		".1.."
	},
	["Ф"] = {
		"1111",
		"1..1",
		"1..1",
		"1111",
		".11."
	},
	["Х"] = {
		"1..1",
		"1..1",
		".11.",
		"1..1",
		"1..1"
	},
	["Ц"] = {
		"1.1.",
		"1.1.",
		"1.1.",
		"1111",
		"...1"
	},
	["Ч"] = {
		"1..1",
		"1..1",
		"1111",
		"...1",
		"...1"
	},
	["Ш"] = {
		"1.11",
		"1.11",
		"1.11",
		"1.11",
		"1111"
	},
	["Щ"] = {
		"1.11",
		"1.11",
		"1.11",
		"1111",
		"...1"
	},
	["Ь"] = {
		"1...",
		"1...",
		"111.",
		"1..1",
		"111."
	},
	["Ы"] = {
		"1..1",
		"1..1",
		"11.1",
		"11.1",
		"11.1"
	},
	["Ъ"] = {
		"11..",
		".1..",
		".111",
		".1.1",
		".111"
	},
	["Э"] = {
		"111.",
		"...1",
		"1111",
		"...1",
		"111."
	},
	["Ю"] = {
		"1.1.",
		"11.1",
		"11.1",
		"11.1",
		"1.1."
	},
	["Я"] = {
		".111",
		"1..1",
		"1111",
		".1.1",
		"1..1"
	},

	----------------small russian font
	["а"] = {
		"....",
		".11.",
		"...1",
		"1111",
		".111"
	},
	["б"] = {
		"....",
		".11.",
		"1...",
		"1111",
		"111."
	},
	["в"] = {
		"....",
		"11..",
		"111.",
		"111.",
		"11.."
	},
	["г"] = {
		"....",
		"1111",
		"1...",
		"1...",
		"1..."
	},
	["д"] = {
		"....",
		".11.",
		"1..1",
		".11.",
		"1..1"
	},
	["е"] = {
		"....",
		"1111",
		"111.",
		"1...",
		"1111"
	},
	["ё"] = {
		".11.",
		"1111",
		"111.",
		"1...",
		"1111"
	},
	["ж"] = {
		"....",
		"1..1",
		".1.1",
		"1.1.",
		"1..1"
	},
	["з"] = {
		"....",
		"1111",
		".11.",
		"...1",
		"111."
	},
	["и"] = {
		"....",
		"1..1",
		"1.11",
		"11.1",
		"1..1"
	},
	["й"] = {
		"..1.",
		"1..1",
		"1.11",
		"11.1",
		"1..1"
	},
	["к"] = {
		"....",
		"1..1",
		"1.1.",
		"11..",
		"1.1."
	},
	["л"] = {
		"....",
		".111",
		"1..1",
		"1..1",
		"1..1"
	},
	["м"] = {
		"....",
		"1111",
		"1.11",
		"1.11",
		"1.11"
	},
	["н"] = {
		"....",
		"1..1",
		"1111",
		"1111",
		"1..1"
	},
	["о"] = {
		"....",
		".11.",
		"1..1",
		"1..1",
		".11."
	},
	["п"] = {
		"....",
		"1111",
		"1..1",
		"1..1",
		"1..1"
	},
	["р"] = {
		"....",
		"111.",
		"1..1",
		"111.",
		"1..."
	},
	["с"] = {
		"....",
		".111",
		"1...",
		"1...",
		".111"
	},
	["т"] = {
		"....",
		"1111",
		".11.",
		".11.",
		".11."
	},
	["у"] = {
		"....",
		"1..1",
		".1.1",
		"..1.",
		".1.."
	},
	["ф"] = {
		"....",
		".11.",
		"1..1",
		"1111",
		".11."
	},
	["х"] = {
		"....",
		"1..1",
		".11.",
		".11.",
		"1..1"
	},
	["ц"] = {
		"....",
		"1.1.",
		"1.1.",
		"1111",
		"...1"
	},
	["ч"] = {
		"....",
		"1..1",
		"1111",
		"...1",
		"...1"
	},
	["ш"] = {
		"....",
		"1.11",
		"1.11",
		"1.11",
		"1111"
	},
	["щ"] = {
		"....",
		"1.11",
		"1.11",
		"1111",
		"...1"
	},
	["ь"] = {
		"....",
		"1...",
		"111.",
		"1..1",
		"111."
	},
	["ы"] = {
		"....",
		"1..1",
		"1..1",
		"11.1",
		"11.1"
	},
	["ъ"] = {
		"....",
		"11..",
		".11.",
		".1.1",
		".11."
	},
	["э"] = {
		"....",
		"111.",
		"1111",
		"...1",
		"111."
	},
	["ю"] = {
		"....",
		"1.1.",
		"11.1",
		"11.1",
		"1.1."
	},
	["я"] = {
		"....",
		".111",
		"1..1",
		".111",
		"1..1"
	},





	------------------------
	["0"] = {
		".11.",
		"1..1",
		"1..1",
		"1..1",
		".11."
	},
	["1"] = {
		".11.",
		"111.",
		".11.",
		".11.",
		"1111"
	},
	["2"] = {
		"111.",
		"...1",
		".11.",
		"1...",
		".111"
	},
	["3"] = {
		"111.",
		"...1",
		"111.",
		"...1",
		"111."
	},
	["4"] = {
		"1..1",
		"1..1",
		"1111",
		"...1",
		"...1"
	},
	["5"] = {
		"1111",
		"1...",
		"111.",
		"...1",
		"111."
	},
	["6"] = {
		".11.",
		"1...",
		"111.",
		"1..1",
		".11."
	},
	["7"] = {
		"1111",
		"...1.",
		".11.",
		".11.",
		".11."
	},
	["8"] = {
		".11.",
		"1..1",
		".11.",
		"1..1",
		".11."
	},
	["9"] = {
		".11.",
		"1..1",
		".111",
		"...1",
		".11."
	},
	["."] = {
		"....",
		"....",
		"....",
		"....",
		"1..."
	},
	[","] = {
		"....",
		"....",
		"....",
		"11..",
		"1..."
	},
	[":"] = {
		"....",
		"1...",
		"....",
		"1...",
		"...."
	},
	[";"] = {
		"....",
		"1...",
		"....",
		"11..",
		"1..."
	},
	["!"] = {
		"1...",
		"1...",
		"1...",
		"....",
		"1..."
	},
	["?"] = {
		"1...",
		".1..",
		"1...",
		"....",
		"1..."
	},
	["'"] = {
		"..1.",
		"..1.",
		"....",
		"....",
		"...."
	},
	['"'] = {
		"1.1.",
		"1.1.",
		"....",
		"....",
		"...."
	},
	["("] = {
		"...1",
		"..1.",
		"..1.",
		"..1.",
		"...1"
	},
	[")"] = {
		"1...",
		".1..",
		".1..",
		".1..",
		"1..."
	},
	["["] = {
		"..11",
		"..1.",
		"..1.",
		"..1.",
		"..11"
	},
	["]"] = {
		"11..",
		".1..",
		".1..",
		".1..",
		"11.."
	},
	["{"] = {
		"...1",
		"..1.",
		".11.",
		"..1.",
		"...1"
	},
	["}"] = {
		"1...",
		".1..",
		".11.",
		".1..",
		"1..."
	},
	["<"] = {
		"...1",
		"..1.",
		".1..",
		"..1.",
		"...1"
	},
	[">"] = {
		"1...",
		".1..",
		"..1.",
		".1..",
		"1..."
	},
	["/"] = {
		"...1",
		"..1.",
		"..1.",
		".1..",
		"1..."
	},
	["\\"] = {
		"1...",
		".1..",
		".1..",
		"..1.",
		"...1"
	},
	["@"] = {
		".111",
		"11.1",
		"1.11",
		"1...",
		".111"
	},
	["#"] = {
		"1..1",
		"1111",
		"1..1",
		"1111",
		"1..1"
	},
	["$"] = {
		".111",
		"1.1.",
		".11.",
		".1.1",
		"111."
	},
	["%"] = {
		"1..1",
		"..1.",
		"..1.",
		".1..",
		"1..1"
	},
	["^"] = {
		".1..",
		"1.1.",
		"....",
		"....",
		"...."
	},
	["&"] = {
		".11.",
		"1..1",
		".1..",
		"1.11",
		".111"
	},
	["*"] = {
		"1..1",
		".11.",
		"1..1",
		"....",
		"...."
	},
	["+"] = {
		"....",
		".11.",
		"1111",
		".11.",
		"...."
	},
	["-"] = {
		"....",
		"....",
		"1111",
		"....",
		"...."
	},
	["_"] = {
		"....",
		"....",
		"....",
		"....",
		"1111"
	},
	[" "] = {
		"....",
		"....",
		"....",
		"....",
		"...."
	},
	["="] = {
		"....",
		"1111",
		"....",
		"1111",
		"...."
	},
	["`"] = {
		"1...",
		".1..",
		"....",
		"....",
		"...."
	},
	["~"] = {
		"....",
		"1.1.",
		".1.1",
		"....",
		"...."
	},
	["№"] = {
		"...1",
		"1...",
		"11.1",
		"1.11",
		"1..1"
	},
}

font.chars.error = {
	"1111",
	"1..1",
	"1..1",
	"1..1",
	"1111"
}

local pairs = pairs
local ipairs = ipairs
local table_insert = table.insert
local string_byte = string.byte
function font.optimizeFont(chars, width, height)
    local optimized = {}

    local pixels
    local chr
    for k, v in pairs(chars) do
        pixels = {}

        for iy, w in ipairs(v) do
            for ix = 1, width do
                chr = w:sub(ix, ix)
                if chr == "1" then
                    table_insert(pixels, ix-1)
                    table_insert(pixels, iy-1)
                end
            end
        end

        optimized[k] = pixels
        if #k == 1 then
            optimized[string_byte(k)] = pixels
        end
    end

    return optimized
end

font.optimized = font.optimizeFont(font.chars, font.width, font.height)